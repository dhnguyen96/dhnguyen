<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Feedback</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./css/bootstrap.min.css" />

    <!-- Images/icons -->
    <link rel="stylesheet" href="./css/all.min.css" />

    <!-- CSS file -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="./css/feedback-style.css" />
    <link rel="stylesheet" href="./vendor/owl-carousel/css/owl.carousel.min.css" />
    <link rel="stylesheet" href="./vendor/owl-carousel/css/owl.theme.default.min.css" />
    <link rel="stylesheet" href="./css/responsive.css" />
</head>

<body>
    <!-- ********** HEADER ********** -->
  <header class="header">
    <div class="main-menu">
      <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <div class="me-auto"></div>
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="index.html#about">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="index.html#projects">Projects</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="index.html#skills">Skills & Experiences</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>
  </header>
  <!-- ********** END HEADER ********** -->
    <div class="container">
        <h1 class="feedback-title animate__animated animate__slideInLeft">Have any <span>feedback</span>?</h1>
        <div class="wrapper animate__animated animate__slideInDown">
            <div class="feedback-area">
                <h1 class="feedback-info">My Contact Information</h1>
                <ul>
                    <li><a href="https://github.com/dhnguyen96/dhnguyen" target="_blank"><i
              class="fab fa-github"></i> GitHub</a></li>
                    <li><a href="https://www.linkedin.com/in/dustin-nguyen-a984b7113/" target="_blank"><i
                        class="fab fa-linkedin"></i> LinkedIn</a></li>
                    <li><a href="mailto: dustyn96@gmail.com" target="_blank"><i class="fas fa-envelope"></i> dustyn96@gmail.com</a></li>
                </ul>
                <i class="far fa-comment-dots fa-7x"></i>
                <div class="feedback-line"></div>
            </div>
            <div class="feedback-form">
                <h3>Let's talk</h3>
                <div class="alert">Your feedback has been submitted!</div>
                <div id="msg"></div>
                <div id="err"></div>
                <div id="token"></div>
                <div id="notis"></div>
                <form id="feedbackForm">
                    <p>
                        <label>Name</label>
                        <input type="text" name="name" id="name" required>
                    </p>
                    <p>
                        <label>Company (optional)</label>
                        <input type="text" name="company" id="company">
                    </p>
                    <p>
                        <label>Email Address</label>
                        <input type="email" name="email" id="email" required> 
                    </p>
                    <p>
                        <label>Phone Number (optional)</label>
                        <input type="text" name="phone" id="phone">
                    </p>
                    <p class="stretch">
                        <label>Feedback</label>
                        <textarea type="text" name="feedback" rows="5" id="message"></textarea>
                    </p>
                    <p class="stretch">
                        <button onclick="requestPermission()">Submit</button>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <footer class="footer-area" id="footer">
        <div class="container">
          <div class="">
            <div class="social text-center">
              <h5 class="text-uppercase">Connect with me</h5>
              <a href="https://www.linkedin.com/in/dustin-nguyen-a984b7113/" target="_blank"><i
                  class="fab fa-linkedin fa-2x"></i></a>
              <a href="https://github.com/dhnguyen96/dhnguyen" target="_blank"><i class="fab fa-github fa-2x"></i></a>
              <a href="mailto: dustyn96@gmail.com" target="_blank"><i class="fa fa-mail-bulk fa-2x"></i></a>
            </div>
          </div>
        </div>
      </footer>

<!-- Jquery -->
<script src="./js/jquery.3.5.1.js"></script>
<!-- Bootstrap JS -->
<script src="./js/bootstrap.min.js"></script>
<!--JS -->
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-messaging.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.6/firebase-analytics.js"></script>
<script src="./feedback.js"></script>
<script src="./js/navbar.js"></script>
<!-- Firebase -->
<script>
  // Retrieve Firebase Messaging object.
  const messaging = firebase.messaging();

  // IDs of divs that display registration token UI or request permission UI.
  const tokenDivId = 'token_div';
  const permissionDivId = 'permission_div';

  // Handle incoming messages. Called when:
  // - a message is received while the app has focus
  // - the user clicks on an app notification created by a service worker
  //   `messaging.onBackgroundMessage` handler.
  messaging.onMessage((payload) => {
    console.log('Message received. ', payload);
    // Update the UI to include the received message.
    appendMessage(payload);
  });

  function resetUI() {
    clearMessages();
    showToken('loading...');
    // Get registration token. Initially this makes a network call, once retrieved
    // subsequent calls to getToken will return from cache.
    messaging.getToken({vapidKey: '<YOUR_PUBLIC_VAPID_KEY_HERE>'}).then((currentToken) => {
      if (currentToken) {
        sendTokenToServer(currentToken);
        updateUIForPushEnabled(currentToken);
      } else {
        // Show permission request.
        console.log('No registration token available. Request permission to generate one.');
        // Show permission UI.
        updateUIForPushPermissionRequired();
        setTokenSentToServer(false);
      }
    }).catch((err) => {
      console.log('An error occurred while retrieving token. ', err);
      showToken('Error retrieving registration token. ', err);
      setTokenSentToServer(false);
    });
  }


  function showToken(currentToken) {
    // Show token in console and UI.
    const tokenElement = document.querySelector('#token');
    tokenElement.textContent = currentToken;
  }

  // Send the registration token your application server, so that it can:
  // - send messages back to this app
  // - subscribe/unsubscribe the token from topics
  function sendTokenToServer(currentToken) {
    if (!isTokenSentToServer()) {
      console.log('Sending token to server...');
      // TODO(developer): Send the current token to your server.
      setTokenSentToServer(true);
    } else {
      console.log('Token already sent to server so won\'t send it again ' +
          'unless it changes');
    }
  }

  function isTokenSentToServer() {
    return window.localStorage.getItem('sentToServer') === '1';
  }

  function setTokenSentToServer(sent) {
    window.localStorage.setItem('sentToServer', sent ? '1' : '0');
  }

  function showHideDiv(divId, show) {
    const div = document.querySelector('#' + divId);
    if (show) {
      div.style = 'display: visible';
    } else {
      div.style = 'display: none';
    }
  }

  function requestPermission() {
    console.log('Requesting permission...');
    Notification.requestPermission().then((permission) => {
      if (permission === 'granted') {
        console.log('Notification permission granted.');
        // TODO(developer): Retrieve a registration token for use with FCM.
        // In many cases once an app has been granted notification permission,
        // it should update its UI reflecting this.
        resetUI();
      } else {
        console.log('Unable to get permission to notify.');
      }
    });
  }

  function deleteToken() {
    // Delete registration token.
    messaging.getToken().then((currentToken) => {
      messaging.deleteToken(currentToken).then(() => {
        console.log('Token deleted.');
        setTokenSentToServer(false);
        // Once token is deleted update UI.
        resetUI();
      }).catch((err) => {
        console.log('Unable to delete token. ', err);
      });
    }).catch((err) => {
      console.log('Error retrieving registration token. ', err);
      showToken('Error retrieving registration token. ', err);
    });
  }

  // Add a message to the messages element.
  function appendMessage(payload) {
    const messagesElement = document.querySelector('#messages');
    const dataHeaderElement = document.createElement('h5');
    const dataElement = document.createElement('pre');
    dataElement.style = 'overflow-x:hidden;';
    dataHeaderElement.textContent = 'Received message:';
    dataElement.textContent = JSON.stringify(payload, null, 2);
    messagesElement.appendChild(dataHeaderElement);
    messagesElement.appendChild(dataElement);
  }

  // Clear the messages element of all children.
  function clearMessages() {
    const messagesElement = document.querySelector('#messages');
    while (messagesElement.hasChildNodes()) {
      messagesElement.removeChild(messagesElement.lastChild);
    }
  }

  function updateUIForPushEnabled(currentToken) {
    showHideDiv(tokenDivId, true);
    showHideDiv(permissionDivId, false);
    showToken(currentToken);
  }

  function updateUIForPushPermissionRequired() {
    showHideDiv(tokenDivId, false);
    showHideDiv(permissionDivId, true);
  }

  resetUI();
</script>
</body>

</html>